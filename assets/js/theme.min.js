(function( $ ) {
    'use strict';
    var resizeTimer;
    // Fire on document ready.
    $( document ).ready( function() {
        alacarte_StickyHeader();
        alacarte_toggle_menu();
        alacarte_touched_side();
        alacarte_open_mobile_menu();
        alacarte_popup();
        alacarte_toggle();
        alacarte_side_nav();
        alacarte_video_size();
        alacarte_vcRow();
        alacarte_inlineCss();
    });
    // On Load 
    $(window).load(function() {
        alacarte_page_loading();
        alacarte_vcRow();
    });
    // On scroll
    $( window ).scroll( function() {
    });
    // On Resize
    $( window ).resize( function() {
        clearTimeout( resizeTimer );
        alacarte_touched_side();
        alacarte_vcRow();
    });

    /**
     * Add page loading
    */
    function alacarte_page_loading(){
        'use strict';
        $("#red-loading").fadeOut("slow");
    }
    /**
     * Sticky Header 
    */
    function alacarte_StickyHeader(){
        'use strict';
        var c, currentScrollTop = 0,
           navbar = $('.sticky-on'),
           menu = navbar.find('#red-header-menu');
        $(window).scroll(function () {
          var a = $(window).scrollTop();
          var b = navbar.height();
          currentScrollTop = a;
          if (c < currentScrollTop && a > b + b) {
            navbar.removeClass('header-sticky').addClass('scrollDown');
            if(navbar.hasClass('header-ontop-sticky')){
                navbar.addClass('header-ontop');
                menu.addClass('menu-ontop').removeClass('menu-sticky');
            }
            if(navbar.hasClass('header-default-sticky')){
                navbar.addClass('header-default');
                menu.addClass('menu-default').removeClass('menu-sticky');
            }
          } else if (c > currentScrollTop && !(a <= b)) {
            navbar.addClass('header-sticky').removeClass('scrollDown');
            if(navbar.hasClass('header-ontop-sticky')) {
                navbar.removeClass('header-ontop');
                menu.removeClass('menu-ontop').addClass('menu-sticky');
            }
            if(navbar.hasClass('header-default-sticky')) {
                navbar.removeClass('header-default');
                menu.removeClass('menu-default').addClass('menu-sticky');
            }
          } else if(c > currentScrollTop){
            navbar.removeClass('header-sticky');
            if(navbar.hasClass('header-ontop-sticky')) {
                navbar.addClass('header-ontop');
                menu.addClass('menu-ontop').removeClass('menu-sticky');
            }
            if(navbar.hasClass('header-default-sticky')) {
                navbar.addClass('header-default');
                menu.addClass('menu-default').removeClass('menu-sticky');
            }
          }
          c = currentScrollTop;
        });
    }
    /**
     * Toggle Menu 
    */
    function alacarte_toggle_menu(){
        'use strict';
        $('.red-toggle').on('click', function(){
            $(this).find('.red-toggle-inner').toggleClass('active');
            $(this).next().slideToggle();
        });
    }
    /**
     * Menu Back
     * Sub menu touched on side left/right
    */
    function alacarte_touched_side(){
        'use strict';
        var $menu = $('.red-header-menu');
        if($(window).width() > 1200 ){
            $menu.find('li').each(function(){
                var $submenu = $(this).find('> .red-dropdown');
                if($submenu.length > 0){
                    if($submenu.offset().left + $submenu.outerWidth() > $(window).innerWidth()){
                        $submenu.addClass('touched');
                    } else if($submenu.offset().left < 0){
                        $submenu.addClass('touched');
                    }
                    /* remove css style display from mobile to desktop menu */
                    $submenu.css('display','');
                }            
            });
        }
    }

    /**
     * Open Mobile Menu 
    */
    function alacarte_open_mobile_menu(){
        'use strict';
        $("#red-main-menu-mobile").on('click',function(){
            $(this).toggleClass('opened');
            $('#red-navigation').slideToggle();
        })
    }
    /**
     * Popup
    */
    function alacarte_popup(){
        'use strict';
        if(typeof $.magnificPopup != 'undefined'){
            /* ===================
             Popup Images Gallery
             ===================== */
            $('.red-gallery').each(function() {
                $(this).magnificPopup({
                    delegate: 'a.light-box',
                    type: 'image',
                    gallery: {
                        enabled: true
                    },
                    titleSrc: 'title',
                    removalDelay: 300,
                    mainClass: 'mfp-with-zoom mfp-gallery',
                    closeBtnInside: false,
                    zoom: {
                        //enabled: true,
                        duration: 300,
                        easing: 'ease-in-out', 
                        opener: function(openerElement) {
                            return openerElement.is('img') ? openerElement : openerElement.find('img');
                        }
                    }
                });
            });
            /* ===================
             Header Icon Popup
             ===================== */
             $('.red-header-popup').magnificPopup({
                type:'inline',
                closeBtnInside: false,
                removalDelay: 300,
                mainClass: 'mfp-with-zoom',
                focus: '.search-field',
                zoom: {
                    enabled: true,
                    duration: 500,
                    easing: 'ease-in-out', 
                    opener: function(openerElement) {
                        return openerElement.is('img') ? openerElement : openerElement.find('img');
                    }
                }
            });
            /* ===================
             Popup Inline HTML
             with content verticle middle
             ===================== */
             $('.mfp-inline').magnificPopup({
                type:'inline',
                closeBtnInside: false,
                removalDelay: 300,
                mainClass: 'mfp-with-zoom',
                zoom: {
                    enabled: true,
                    duration: 500,
                    easing: 'ease-in-out', 
                    opener: function(openerElement) {
                        return openerElement.is('img') ? openerElement : openerElement.find('img');
                    }
                }
            });
            /*==================
             Popup Iframe
             show youtube, vimeo, google maps and more 
            ====================*/
            $('.popup-iframe').magnificPopup({
               //disableOn: 700,
               type: 'iframe',
               mainClass: 'mfp-fade',
               removalDelay: 160,
               preloader: false,
               fixedContentPos: false
            });
        }
    }
    /**
     * Toggle
    */
    function alacarte_toggle(){
        /* ===================
         Search Toggle
         ===================== */
        $('.red-search-toggle').on('click',function(e){
            e.preventDefault();
            $('.red-cartform').removeClass('active');
            $('.red-searchform').toggleClass('active').find('.red-search-field').focus();
        });
        $('.red-search-submit').on('click',function(e){
            if( $(this).parent().find('.red-search-field').val() == '' ) {
                e.preventDefault();
                $(this).parents('.red-searchform').removeClass('active');
            }
        });

        /* ===================
         Cart Toggle
         ===================== */
        $('.red-cart-toggle').on('click',function(e){
            e.preventDefault();
            $('.red-searchform').removeClass('active');
            $('.red-cartform').toggleClass('active').slideToggle();
        });
    }
    /**
     * Side Nav
    */
    function alacarte_side_nav(){
        /* Sidebar Nav */
        $("#red-main-sidenav .open-menu").on('click',function(){
            $(this).toggleClass('opened');
            $('#red-page').toggleClass('sidenav-open');
            $('#red-sidenav').toggleClass('open');
        })
        $('#red-close-sidenav').on('click',function(){
            $('#red-page').removeClass('sidenav-open');
            $('#red-sidenav').removeClass('open');
            $('#red-main-sidenav .btn-nav-mobile').removeClass('opened');
        })
    }
    /**
     * Media Embed dimensions
     * 
     * Youtube, Vimeo, Iframe, Video, Audio.
     * @author Chinh Duong Manh
     */
    function alacarte_video_size() {
        'use strict';
        setTimeout(function(){
            $('.red-featured iframe , .red-featured  video, .red-featured .wp-video-shortcode').each(function(){
                var v_width = $(this).parent().width();
                var v_height = Math.floor(v_width / (16/9));
                $(this).attr('width',v_width).css('width',v_width);
                $(this).attr('height',v_height).css('height',v_height);
            });
        }, 100);
    }
    // VC Row 
    function alacarte_vcRow() {
        'use strict';
        //if($(window).width() < 1200 ) return;
        var $site_boxed      = $('.site-boxed [data-vc-full-width="true"]'),
            $site_bordered   = $('.site-bordered [data-vc-full-width="true"]'),
            bordered_left    = parseInt($('body').css('padding-left')),
            bordered_right   = parseInt($('body').css('padding-right')),
            $header_layout_3 = $('body.header-3:not(site-boxed) [data-vc-full-width="true"]'),
            $header_layout_3_boxed = $('body.header-3.site-boxed [data-vc-full-width="true"]'),
            rtl = $('html[dir="rtl"]');

        setTimeout(function() {
            // boxed
            $.each($site_boxed, function(key, item) {
                var $el = $(this),
                    offset = parseInt($el.css('left').replace('-',''));
                if($el.data("vcStretchContent")){
                    $el.css({
                        'padding-left': offset + bordered_right + 'px',
                        'padding-right': offset + bordered_left + 'px'
                    });
                }
            }), 
            $(document).trigger("vc-full-width-row", $site_boxed);
            // bordered 
            $.each($site_bordered, function(key, item) {
                var $el = $(this);
                if($el.data("vcStretchContent")){
                    $el.css({
                        'padding-left': bordered_left + 'px',
                        'padding-right': bordered_right + 'px',
                    });
                }
            }), 
            $(document).trigger("vc-full-width-row", $site_bordered);
            // Header Layout 3
            $.each($header_layout_3, function(key, item) {
                var $el = $(this),
                    offset = parseInt($el.css('left').replace('-',''));
                if($el.data("vcStretchContent")){
                    if(rtl.length){
                        $el.css({
                            'padding-right': bordered_right + 'px',
                        });
                    } else {
                        $el.css({
                            'padding-left': bordered_left + 'px',
                        });
                    }
                } else {
                    if(rtl.length){
                        $el.css({
                            'padding-left': offset - bordered_right + 'px',
                        });
                    }
                }
            }), 
            $(document).trigger("vc-full-width-row", $header_layout_3);

            // Header Layout 3 & Boxed || Bordered
            $.each($header_layout_3_boxed, function(key, item) {
                var $el = $(this),
                    offset = parseInt($el.css('left').replace('-',''));
                if($el.data("vcStretchContent")){
                    if(rtl.length){
                        $el.css({
                            'padding-left': offset - bordered_right + 'px',
                            'padding-right': offset - bordered_left + 'px',
                        });
                    } else {
                        $el.css({
                            'padding-left': offset - bordered_right + 'px',
                            'padding-right': offset - bordered_left + 'px',
                        });
                    }
                } else {
                    if(rtl.length){
                        $el.css({
                            'padding-left': offset - bordered_right + 'px',
                        });
                    }
                }
            }), 
            $(document).trigger("vc-full-width-row", $header_layout_3_boxed);

            /* Fix width for Rev slider */
            //$elements.find('.rev_slider.fullwidthabanner').css({'width': '100%', 'left': ''});
        }, 0 );
    }
    // Inline CSS to head
    function alacarte_inlineCss(){
        var _inline_css = '<style class="red-inline-css">';
        $(document).find('div.red-inline-css').each(function () {
            var _this = $(this);
            _inline_css += _this.attr("data-css");
            _this.remove();
        });
        _inline_css += '</style>';
        $('head').append(_inline_css);
    }
})( jQuery );

/* Hover Effect */
(function ($) { 
    'use strict';
    function ZKHoverDirection(ev, obj) {
        var w = $(obj).width(),
            h = $(obj).height(),
            x = (ev.pageX - $(obj).offset().left - (w / 2)) * (w > h ? (h / w) : 1),
            y = (ev.pageY - $(obj).offset().top - (h / 2)) * (h > w ? (w / h) : 1),
            d = Math.round( Math.atan2(y, x) / 1.57079633 + 5 ) % 4;
        return d;
    }
    function ZKHoverDirClass( ev, obj, state,current_class ) {
        'use strict';
        var direction = ZKHoverDirection( ev, obj ),
            class_suffix = null;
        
        switch ( direction ) {
            case 0 : class_suffix = '-top';    break;
            case 1 : class_suffix = '-right';  break;
            case 2 : class_suffix = '-bottom'; break;
            case 3 : class_suffix = '-left';   break;
        }
        $(obj).attr('class',current_class+ ' '+ state + class_suffix );
    }
    $.fn.ZKHoverDir = function () {
        'use strict';
        this.each(function () {
            var gl_class = '';
            $(this).addClass('hover-dir');
            $(this).hover(function(ev){
                gl_class = gl_class === '' ? $(this).attr('class') : gl_class;
                ZKHoverDirClass( ev, this, 'in',gl_class );
            },function(ev){
                gl_class = gl_class === '' ? $(this).attr('class') : gl_class;
                ZKHoverDirClass( ev, this, 'out',gl_class );
            })
        })
    }
    $('.hoverdir-wrap').ZKHoverDir();
    $('.btn').ZKHoverDir();
    //$('button').addClass('btn').wrapInner( "<span></span>").ZKHoverDir();
    //$('.button').addClass('btn').wrapInner( "<span></span>").ZKHoverDir();
    //$('.single_add_to_cart_button').removeClass('button alt');
})(jQuery);

jQuery(document).ready(function() {
    alacarte_btt_start();
    jQuery(window).scroll(function(e) {
        alacarte_btt_start();
    });
    jQuery('#red-btt-circle').click(function() {
        jQuery('html, body').animate({
            scrollTop: 0
        }, 'slow');
    });
});

function alacarte_btt_start() {
    var scrollTop = jQuery(window).scrollTop();
    var docHeight = jQuery(document).height();
    var winHeight = jQuery(window).height();
    var scrollPercent = (scrollTop) / (docHeight - winHeight);
    var scrollPercentRounded = Math.round(scrollPercent * 100);
    
    if (scrollPercentRounded > scrollPercent) {
        if (jQuery('#red-btt-btn').hasClass('show')) {} else {
            jQuery('#red-btt-btn').addClass('show');
        }
    } else {
        jQuery('#red-btt-btn').removeClass('show');
    }
    alacarte_btt_btn(scrollPercentRounded);
};

function alacarte_btt_btn(i) {
    prec = i * 3.6;
    jQuery('#red-btt-prec').html(i + '%');
    var borderColor = jQuery('body').data('primary-color'); //'rgb(238, 238, 238)',
        borderActiveColor = jQuery('body').data('accent-color'); //'rgb(61, 201, 179)';
    if (prec <= 180) {
        jQuery('#red-btt-border').css('background-image', 'linear-gradient(' + (prec + 90) + 'deg, transparent 50%, ' + borderColor + ' 50%),linear-gradient(90deg, ' + borderColor + ' 50%, transparent 50%)');
    } else {
        jQuery('#red-btt-border').css('background-image', 'linear-gradient(' + (prec - 90) + 'deg, transparent 50%, ' + borderActiveColor + ' 50%),linear-gradient(90deg, ' + borderColor + ' 50%, transparent 50%)');
    }
};